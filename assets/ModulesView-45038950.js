import{a6 as Ve,a7 as Le,d as W,z as Te,a2 as fe,a1 as ge,A as ve,h as Fe,P as K,b as ue,N as Me,g as De,ac as ae,ad as Ue,w as ce,a9 as Ae,am as ie}from"./router-a3ed6b9b.js";import{u as de,f as G,j as Ie,c as je,a as be,d as Q,g as _e,W as Oe,i as h,h as oe,e as D,N as pe,R as le,T as P,_ as We}from"./Icon-256e2cea.js";import{a as Pe,d as L,p as se}from"./index-714b5119.js";import{d as Z,c as U,h as v,r as T,a1 as ye,n as He,f as E,l as N,m as x,a as he,k as l,j as p,W as H,a8 as me,F as Ee,al as Ne,ah as Ke}from"./plugin-vueexport-helper-64b0a016.js";import{_ as Ge,E as Xe}from"./Edit-e628cf74.js";import{t as Ye,_ as qe,c as Je,a as Qe}from"./Rate-7afa0e7e.js";import{u as Ze}from"./use-locale-24efefdf.js";import{g as et,i as tt,a as we,b as nt,c as at,d as it,_ as ot}from"./Grid-cb12efef.js";import{A as lt}from"./Add-ebcce62a.js";import{u as st}from"./use-message-bfd9ee41.js";import{_ as rt}from"./Table-3dead094.js";import{_ as dt}from"./Modal-6cb1de9b.js";import{_ as ut}from"./Image-397f2f14.js";import{_ as ct}from"./InputNumber-12202fae.js";import"./context-67d59cb1.js";import"./Card-c7acf0a4.js";import"./_createCompounder-1e09d40a.js";function pt(t){switch(t){case"tiny":return"mini";case"small":return"tiny";case"medium":return"small";case"large":return"medium";case"huge":return"large"}throw Error(`${t} has no smaller size.`)}const ht={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},mt=()=>ht,ft={name:"Space",self:mt},xe=ft;let re;const gt=()=>{if(!Ve)return!0;if(re===void 0){const t=document.createElement("div");t.style.display="flex",t.style.flexDirection="column",t.style.rowGap="1px",t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div")),document.body.appendChild(t);const m=t.scrollHeight===1;return document.body.removeChild(t),re=m}return re},vt=Object.assign(Object.assign({},G.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,size:{type:[String,Number,Array],default:"medium"},wrapItem:{type:Boolean,default:!0},itemStyle:[String,Object],wrap:{type:Boolean,default:!0},internalUseGap:{type:Boolean,default:void 0}}),bt=Z({name:"Space",props:vt,setup(t){const{mergedClsPrefixRef:m,mergedRtlRef:b}=de(t),c=G("Space","-space",void 0,xe,t,m),f=Ie("Space",b,m);return{useGap:gt(),rtlEnabled:f,mergedClsPrefix:m,margin:U(()=>{const{size:i}=t;if(Array.isArray(i))return{horizontal:i[0],vertical:i[1]};if(typeof i=="number")return{horizontal:i,vertical:i};const{self:{[W("gap",i)]:e}}=c.value,{row:k,col:S}=Pe(e);return{horizontal:L(S),vertical:L(k)}})}},render(){const{vertical:t,align:m,inline:b,justify:c,itemStyle:f,margin:i,wrap:e,mergedClsPrefix:k,rtlEnabled:S,useGap:_,wrapItem:z,internalUseGap:a}=this,n=Le(et(this));if(!n.length)return null;const d=`${i.horizontal}px`,o=`${i.horizontal/2}px`,F=`${i.vertical}px`,C=`${i.vertical/2}px`,R=n.length-1,$=c.startsWith("space-");return v("div",{role:"none",class:[`${k}-space`,S&&`${k}-space--rtl`],style:{display:b?"inline-flex":"flex",flexDirection:t?"column":"row",justifyContent:["start","end"].includes(c)?"flex-"+c:c,flexWrap:!e||t?"nowrap":"wrap",marginTop:_||t?"":`-${C}`,marginBottom:_||t?"":`-${C}`,alignItems:m,gap:_?`${i.vertical}px ${i.horizontal}px`:""}},!z&&(_||a)?n:n.map((y,g)=>v("div",{role:"none",style:[f,{maxWidth:"100%"},_?"":t?{marginBottom:g!==R?F:""}:S?{marginLeft:$?c==="space-between"&&g===R?"":o:g!==R?d:"",marginRight:$?c==="space-between"&&g===0?"":o:"",paddingTop:C,paddingBottom:C}:{marginRight:$?c==="space-between"&&g===R?"":o:g!==R?d:"",marginLeft:$?c==="space-between"&&g===0?"":o:"",paddingTop:C,paddingBottom:C}]},y)))}}),_t=je({name:"DynamicTags",common:be,peers:{Input:tt,Button:Te,Tag:Ye,Space:xe},self(){return{inputWidth:"64px"}}}),yt=_t,wt=Q("dynamic-tags",[Q("input",{minWidth:"var(--n-input-width)"})]),xt=Object.assign(Object.assign(Object.assign({},G.props),Je),{size:{type:String,default:"medium"},closable:{type:Boolean,default:!0},defaultValue:{type:Array,default:()=>[]},value:Array,inputStyle:[String,Object],inputProps:Object,max:Number,tagStyle:[String,Object],renderTag:Function,onCreate:{type:Function,default:t=>t},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]}),kt=Z({name:"DynamicTags",props:xt,setup(t){const{mergedClsPrefixRef:m,inlineThemeDisabled:b}=de(t),{localeRef:c}=Ze("DynamicTags"),f=fe(t),{mergedDisabledRef:i}=f,e=T(""),k=T(!1),S=T(!0),_=T(null),z=G("DynamicTags","-dynamic-tags",wt,yt,t,m),a=T(t.defaultValue),n=ye(t,"value"),d=ge(n,a),o=U(()=>c.value.add),F=U(()=>pt(t.size)),C=U(()=>i.value||!!t.max&&d.value.length>=t.max);function R(u){const{onChange:w,"onUpdate:value":V,onUpdateValue:I}=t,{nTriggerFormInput:r,nTriggerFormChange:X}=f;w&&K(w,u),I&&K(I,u),V&&K(V,u),a.value=u,r(),X()}function $(u){const w=d.value.slice(0);w.splice(u,1),R(w)}function y(u){switch(u.key){case"Enter":g()}}function g(u){const w=u??e.value;if(w){const V=d.value.slice(0);V.push(t.onCreate(w)),R(V)}k.value=!1,S.value=!0,e.value=""}function A(){g()}function M(){k.value=!0,He(()=>{var u;(u=_.value)===null||u===void 0||u.focus(),S.value=!1})}const B=U(()=>{const{self:{inputWidth:u}}=z.value;return{"--n-input-width":u}}),s=b?_e("dynamic-tags",void 0,B,t):void 0;return{mergedClsPrefix:m,inputInstRef:_,localizedAdd:o,inputSize:F,inputValue:e,showInput:k,inputForceFocused:S,mergedValue:d,mergedDisabled:i,triggerDisabled:C,handleInputKeyUp:y,handleAddClick:M,handleInputBlur:A,handleCloseClick:$,handleInputConfirm:g,mergedTheme:z,cssVars:b?void 0:B,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){const{mergedTheme:t,cssVars:m,mergedClsPrefix:b,onRender:c,renderTag:f}=this;return c==null||c(),v(bt,{class:[`${b}-dynamic-tags`,this.themeClass],size:"small",style:m,theme:t.peers.Space,themeOverrides:t.peerOverrides.Space,itemStyle:"display: flex;"},{default:()=>{const{mergedTheme:i,tagStyle:e,type:k,round:S,size:_,color:z,closable:a,mergedDisabled:n,showInput:d,inputValue:o,inputStyle:F,inputSize:C,inputForceFocused:R,triggerDisabled:$,handleInputKeyUp:y,handleInputBlur:g,handleAddClick:A,handleCloseClick:M,handleInputConfirm:B,$slots:s}=this;return this.mergedValue.map((u,w)=>f?f(u,w):v(qe,{key:w,theme:i.peers.Tag,themeOverrides:i.peerOverrides.Tag,style:e,type:k,round:S,size:_,color:z,closable:a,disabled:n,onClose:()=>M(w)},{default:()=>typeof u=="string"?u:u.label})).concat(d?s.input?s.input({submit:B,deactivate:g}):v(we,Object.assign({placeholder:"",size:C,style:F,autosize:!0},this.inputProps,{ref:"inputInstRef",value:o,onUpdateValue:u=>{this.inputValue=u},theme:i.peers.Input,themeOverrides:i.peerOverrides.Input,onKeyup:y,onBlur:g,internalForceFocus:R})):s.trigger?s.trigger({activate:A,disabled:$}):v(ve,{dashed:!0,disabled:$,theme:i.peers.Button,themeOverrides:i.peerOverrides.Button,size:C,onClick:A},{icon:()=>v(Fe,{clsPrefix:b},{default:()=>v(lt,null)})}))}})}}),St={buttonHeightSmall:"14px",buttonHeightMedium:"18px",buttonHeightLarge:"22px",buttonWidthSmall:"14px",buttonWidthMedium:"18px",buttonWidthLarge:"22px",buttonWidthPressedSmall:"20px",buttonWidthPressedMedium:"24px",buttonWidthPressedLarge:"28px",railHeightSmall:"18px",railHeightMedium:"22px",railHeightLarge:"26px",railWidthSmall:"32px",railWidthMedium:"40px",railWidthLarge:"48px"},Ct=t=>{const{primaryColor:m,opacityDisabled:b,borderRadius:c,textColor3:f}=t,i="rgba(0, 0, 0, .14)";return Object.assign(Object.assign({},St),{iconColor:f,textColor:"white",loadingColor:m,opacityDisabled:b,railColor:i,railColorActive:m,buttonBoxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",buttonColor:"#FFF",railBorderRadiusSmall:c,railBorderRadiusMedium:c,railBorderRadiusLarge:c,buttonBorderRadiusSmall:c,buttonBorderRadiusMedium:c,buttonBorderRadiusLarge:c,boxShadowFocus:`0 0 0 2px ${Oe(m,{alpha:.2})}`})},zt={name:"Switch",common:be,self:Ct},Rt=zt,$t=Q("switch",`
 height: var(--n-height);
 min-width: var(--n-width);
 vertical-align: middle;
 user-select: none;
 -webkit-user-select: none;
 display: inline-flex;
 outline: none;
 justify-content: center;
 align-items: center;
`,[h("children-placeholder",`
 height: var(--n-rail-height);
 display: flex;
 flex-direction: column;
 overflow: hidden;
 pointer-events: none;
 visibility: hidden;
 `),h("rail-placeholder",`
 display: flex;
 flex-wrap: none;
 `),h("button-placeholder",`
 width: calc(1.75 * var(--n-rail-height));
 height: var(--n-rail-height);
 `),Q("base-loading",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 font-size: calc(var(--n-button-width) - 4px);
 color: var(--n-loading-color);
 transition: color .3s var(--n-bezier);
 `,[ue({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),h("checked, unchecked",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 box-sizing: border-box;
 position: absolute;
 white-space: nowrap;
 top: 0;
 bottom: 0;
 display: flex;
 align-items: center;
 line-height: 1;
 `),h("checked",`
 right: 0;
 padding-right: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),h("unchecked",`
 left: 0;
 justify-content: flex-end;
 padding-left: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),oe("&:focus",[h("rail",`
 box-shadow: var(--n-box-shadow-focus);
 `)]),D("round",[h("rail","border-radius: calc(var(--n-rail-height) / 2);",[h("button","border-radius: calc(var(--n-button-height) / 2);")])]),pe("disabled",[pe("icon",[D("rubber-band",[D("pressed",[h("rail",[h("button","max-width: var(--n-button-width-pressed);")])]),h("rail",[oe("&:active",[h("button","max-width: var(--n-button-width-pressed);")])]),D("active",[D("pressed",[h("rail",[h("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])]),h("rail",[oe("&:active",[h("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])])])])])]),D("active",[h("rail",[h("button","left: calc(100% - var(--n-button-width) - var(--n-offset))")])]),h("rail",`
 overflow: hidden;
 height: var(--n-rail-height);
 min-width: var(--n-rail-width);
 border-radius: var(--n-rail-border-radius);
 cursor: pointer;
 position: relative;
 transition:
 opacity .3s var(--n-bezier),
 background .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-rail-color);
 `,[h("button-icon",`
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 font-size: calc(var(--n-button-height) - 4px);
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 line-height: 1;
 `,[ue()]),h("button",`
 align-items: center; 
 top: var(--n-offset);
 left: var(--n-offset);
 height: var(--n-button-height);
 width: var(--n-button-width-pressed);
 max-width: var(--n-button-width);
 border-radius: var(--n-button-border-radius);
 background-color: var(--n-button-color);
 box-shadow: var(--n-button-box-shadow);
 box-sizing: border-box;
 cursor: inherit;
 content: "";
 position: absolute;
 transition:
 background-color .3s var(--n-bezier),
 left .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 max-width .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 `)]),D("active",[h("rail","background-color: var(--n-rail-color-active);")]),D("loading",[h("rail",`
 cursor: wait;
 `)]),D("disabled",[h("rail",`
 cursor: not-allowed;
 opacity: .5;
 `)])]),Bt=Object.assign(Object.assign({},G.props),{size:{type:String,default:"medium"},value:{type:[String,Number,Boolean],default:void 0},loading:Boolean,defaultValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:void 0},round:{type:Boolean,default:!0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],checkedValue:{type:[String,Number,Boolean],default:!0},uncheckedValue:{type:[String,Number,Boolean],default:!1},railStyle:Function,rubberBand:{type:Boolean,default:!0},onChange:[Function,Array]});let q;const Vt=Z({name:"Switch",props:Bt,setup(t){q===void 0&&(typeof CSS<"u"?typeof CSS.supports<"u"?q=CSS.supports("width","max(1px)"):q=!1:q=!0);const{mergedClsPrefixRef:m,inlineThemeDisabled:b}=de(t),c=G("Switch","-switch",$t,Rt,t,m),f=fe(t),{mergedSizeRef:i,mergedDisabledRef:e}=f,k=T(t.defaultValue),S=ye(t,"value"),_=ge(S,k),z=U(()=>_.value===t.checkedValue),a=T(!1),n=T(!1),d=U(()=>{const{railStyle:s}=t;if(s)return s({focused:n.value,checked:z.value})});function o(s){const{"onUpdate:value":u,onChange:w,onUpdateValue:V}=t,{nTriggerFormInput:I,nTriggerFormChange:r}=f;u&&K(u,s),V&&K(V,s),w&&K(w,s),k.value=s,I(),r()}function F(){const{nTriggerFormFocus:s}=f;s()}function C(){const{nTriggerFormBlur:s}=f;s()}function R(){t.loading||e.value||(_.value!==t.checkedValue?o(t.checkedValue):o(t.uncheckedValue))}function $(){n.value=!0,F()}function y(){n.value=!1,C(),a.value=!1}function g(s){t.loading||e.value||s.key===" "&&(_.value!==t.checkedValue?o(t.checkedValue):o(t.uncheckedValue),a.value=!1)}function A(s){t.loading||e.value||s.key===" "&&(s.preventDefault(),a.value=!0)}const M=U(()=>{const{value:s}=i,{self:{opacityDisabled:u,railColor:w,railColorActive:V,buttonBoxShadow:I,buttonColor:r,boxShadowFocus:X,loadingColor:J,textColor:ke,iconColor:Se,[W("buttonHeight",s)]:j,[W("buttonWidth",s)]:Ce,[W("buttonWidthPressed",s)]:ze,[W("railHeight",s)]:O,[W("railWidth",s)]:Y,[W("railBorderRadius",s)]:Re,[W("buttonBorderRadius",s)]:$e},common:{cubicBezierEaseInOut:Be}}=c.value;let ee,te,ne;return q?(ee=`calc((${O} - ${j}) / 2)`,te=`max(${O}, ${j})`,ne=`max(${Y}, calc(${Y} + ${j} - ${O}))`):(ee=se((L(O)-L(j))/2),te=se(Math.max(L(O),L(j))),ne=L(O)>L(j)?Y:se(L(Y)+L(j)-L(O))),{"--n-bezier":Be,"--n-button-border-radius":$e,"--n-button-box-shadow":I,"--n-button-color":r,"--n-button-width":Ce,"--n-button-width-pressed":ze,"--n-button-height":j,"--n-height":te,"--n-offset":ee,"--n-opacity-disabled":u,"--n-rail-border-radius":Re,"--n-rail-color":w,"--n-rail-color-active":V,"--n-rail-height":O,"--n-rail-width":Y,"--n-width":ne,"--n-box-shadow-focus":X,"--n-loading-color":J,"--n-text-color":ke,"--n-icon-color":Se}}),B=b?_e("switch",U(()=>i.value[0]),M,t):void 0;return{handleClick:R,handleBlur:y,handleFocus:$,handleKeyup:g,handleKeydown:A,mergedRailStyle:d,pressed:a,mergedClsPrefix:m,mergedValue:_,checked:z,mergedDisabled:e,cssVars:b?void 0:M,themeClass:B==null?void 0:B.themeClass,onRender:B==null?void 0:B.onRender}},render(){const{mergedClsPrefix:t,mergedDisabled:m,checked:b,mergedRailStyle:c,onRender:f,$slots:i}=this;f==null||f();const{checked:e,unchecked:k,icon:S,"checked-icon":_,"unchecked-icon":z}=i,a=!(le(S)&&le(_)&&le(z));return v("div",{role:"switch","aria-checked":b,class:[`${t}-switch`,this.themeClass,a&&`${t}-switch--icon`,b&&`${t}-switch--active`,m&&`${t}-switch--disabled`,this.round&&`${t}-switch--round`,this.loading&&`${t}-switch--loading`,this.pressed&&`${t}-switch--pressed`,this.rubberBand&&`${t}-switch--rubber-band`],tabindex:this.mergedDisabled?void 0:0,style:this.cssVars,onClick:this.handleClick,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},v("div",{class:`${t}-switch__rail`,"aria-hidden":"true",style:c},P(e,n=>P(k,d=>n||d?v("div",{"aria-hidden":!0,class:`${t}-switch__children-placeholder`},v("div",{class:`${t}-switch__rail-placeholder`},v("div",{class:`${t}-switch__button-placeholder`}),n),v("div",{class:`${t}-switch__rail-placeholder`},v("div",{class:`${t}-switch__button-placeholder`}),d)):null)),v("div",{class:`${t}-switch__button`},P(S,n=>P(_,d=>P(z,o=>v(Me,null,{default:()=>this.loading?v(De,{key:"loading",clsPrefix:t,strokeWidth:20}):this.checked&&(d||n)?v("div",{class:`${t}-switch__button-icon`,key:d?"checked-icon":"icon"},d||n):!this.checked&&(o||n)?v("div",{class:`${t}-switch__button-icon`,key:o?"unchecked-icon":"icon"},o||n):null})))),P(e,n=>n&&v("div",{key:"checked",class:`${t}-switch__checked`},n)),P(k,n=>n&&v("div",{key:"unchecked",class:`${t}-switch__unchecked`},n)))))}}),Lt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Tt=x("g",{fill:"none"},[x("path",{d:"M3 4.5A2.5 2.5 0 0 1 5.5 2H17a2.5 2.5 0 0 1 2.5 2.5v6.813a6.475 6.475 0 0 0-1.5-.294V4.5a1 1 0 0 0-1-1H5.5a1 1 0 0 0-1 1V18h6.519c.04.52.14 1.022.294 1.5H4.5a1 1 0 0 0 1 1h6.232A6.518 6.518 0 0 0 12.81 22H5.5A2.5 2.5 0 0 1 3 19.5v-15zM17.5 12a5.5 5.5 0 1 1 0 11a5.5 5.5 0 0 1 0-11zm.501 8.503V18h2.502a.5.5 0 1 0 0-1H18v-2.5a.5.5 0 1 0-1 0V17h-2.504a.5.5 0 0 0 0 1h2.505v2.503a.5.5 0 1 0 1 0zM6 6a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V6zm1.5 1.5h7v-1h-7v1z",fill:"currentColor"})],-1),Ft=[Tt],Mt=Z({name:"BookAdd24Regular",render:function(m,b){return E(),N("svg",Lt,Ft)}});const Dt={id:"ModulesView"},Ut={class:"h1",textcenter:""},At=x("thead",null,[x("tr",null,[x("th",{style:{"text-align":"center"}},"圖片"),x("th",{style:{"text-align":"center"}},"名稱"),x("th",{style:{"text-align":"center"}},"公開狀態"),x("th",{style:{"text-align":"center"}},"管理")])],-1),It={style:{width:"35%"}},jt={style:{width:"40%","font-size":"25px"}},Ot={style:{width:"15%"}},Wt={style:{width:"10%"}},Pt={key:0,style:{"text-align":"center",width:"100%"}},Ht={key:1,style:{"text-align":"center",width:"100%","font-size":"2vw"}},Et=x("div",{style:{"margin-left":"-50px","padding-right":"60px"}}," 小時 ",-1),Nt=x("div",{style:{"margin-left":"-50px","padding-right":"60px"}}," 人 ",-1),Kt={class:"tags-wrapper",style:{background:"#DDA49244","border-radius":"8px",padding:"4%","margin-top":"-1px"}},Gt={style:{display:"flex","justify-content":"flex"}},Xt={style:{display:"flex","justify-content":"flex"}},hn={__name:"ModulesView",setup(t){const m=st(),b=T("medium"),c=T([]),f=a=>{console.log(a.fileList);let n=[],d=[];n=a.fileList.map(o=>o.url).filter(o=>o!==null),d=a.fileList.map(o=>o.file).filter(o=>o!==null),e.image=[...n,...d]},i=he([]),e=he({_id:"",name:"",gm:"",living:!1,image:[],minTime:.5,pl:1,difficulty:.5,hashtag:["19世紀","復活本"],info:"",notice:"",ccfoliaLink:"",discordLink:"",loading:!1,showModal:!1,idx:-1}),k={name:[{required:!0,validator(a,n){if(!n)return new Error("模組名稱必填")},trigger:["input","blur"]}],hashtag:{type:"array",trigger:["change"],validator(a,n){return n.length>=4?new Error("標籤不能超過 3 個"):!0}}},S=a=>{a===-1?(e._id="",e.name="",e.living=!1,e.image=[],e.minTime=.5,e.pl=1,e.difficulty=.5,e.hashtag=[],e.info="",e.notice="",e.ccfoliaLink="",e.discordLink="",e.loading=!1,e.idx=-1,c.value.length=0):(c.value.length=0,e._id=i[a]._id,e.name=i[a].name,e.gm=i[a].gm,e.living=i[a].living,e.image=i[a].image,e.minTime=i[a].minTime,e.pl=i[a].pl,e.difficulty=i[a].difficulty,e.hashtag=i[a].hashtag,e.info=i[a].info,e.notice=i[a].notice,e.ccfoliaLink=i[a].ccfoliaLink,e.discordLink=i[a].discordLink,c.value.push(...e.image.map((n,d)=>({id:d.toString(),name:d.toString(),status:"finished",url:n}))),e.loading=!1,e.idx=a),e.showModal=!0},_=async()=>{var n,d;e.loading=!0;const a=new FormData;a.append("name",e.name),a.append("gm",e.gm),a.append("living",e.living),e.image.length>=1&&e.image.forEach(o=>{a.append("image",o)}),a.append("minTime",e.minTime),a.append("pl",e.pl),a.append("difficulty",e.difficulty);for(const o of e.hashtag)a.append("hashtag",o);a.append("info",e.info),a.append("notice",e.notice),a.append("ccfoliaLink",e.ccfoliaLink),a.append("discordLink",e.discordLink);try{if(e._id.length===0){const{data:o}=await ae.post("/modules",a);i.push(o.result),ie.fire({icon:"success",title:"成功",text:"模組新增成功"})}else{const{data:o}=await ae.patch("/modules/"+e._id,a);i[e.idx]=o.result,ie.fire({icon:"success",title:"成功",text:"編輯成功"})}e.showModal=!1}catch(o){ie.fire({icon:"error",title:"失敗",text:((d=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:d.message)||"發生錯誤"})}e.loading=!1};(async()=>{var a,n;try{const{data:d}=await ae.get("/modules/gm");i.push(...d.result)}catch(d){m.error(((n=(a=d==null?void 0:d.response)==null?void 0:a.data)==null?void 0:n.message)||"發生錯誤")}})();function z(a){console.log(e),_()}return(a,n)=>{const d=Ue,o=ve,F=ut,C=Vt,R=We,$=rt,y=nt,g=we,A=Ge,M=ct,B=kt,s=Qe,u=at,w=it,V=ot,I=dt;return E(),N("div",Dt,[x("div",Ut,[l(d,{dashed:"",style:{"font-size":"3vw",color:"rgb(240,162,23)"}},{default:p(()=>[H(" 模組管理 ")]),_:1})]),l(o,{color:"#5d8585",rounded:"",style:{position:"absolute",top:"18%",right:"10%",padding:"1.5%"},onClick:n[0]||(n[0]=r=>S(-1))},{icon:p(()=>[l(me(Mt),{style:{"font-size":"24px"}})]),default:p(()=>[H(" 新增模組 ")]),_:1}),l($,{id:"moduleTable","single-line":!1,striped:"",style:{"margin-top":"5%"}},{default:p(()=>[At,x("tbody",null,[(E(!0),N(Ee,null,Ne(i,(r,X)=>(E(),N("tr",{key:r._id,style:{"text-align":"center"}},[x("td",It,[l(F,{src:r.image[0],width:200},null,8,["src"])]),x("td",jt,Ke(r.name),1),x("td",Ot,[l(C,{value:r.living,"onUpdate:value":J=>r.living=J},null,8,["value","onUpdate:value"])]),x("td",Wt,[l(o,{strong:"",secondary:"",circle:"",type:"error",onClick:J=>S(X)},{icon:p(()=>[l(R,null,{default:p(()=>[l(me(Xe))]),_:1})]),_:2},1032,["onClick"])])]))),128))])]),_:1}),l(I,{show:e.showModal,"onUpdate:show":n[14]||(n[14]=r=>e.showModal=r),"trap-focus":!1,"mask-closable":!1},{default:p(()=>[l(V,{model:e,rules:k,size:b.value,"label-placement":"top",style:{"background-color":"#F8E9DD","border-radius":"15px",padding:"2%"},onSubmit:ce(z,["prevent"])},{default:p(()=>[l(w,{cols:"6 l:12","item-responsive":"",responsive:"screen","x-gap":"30"},{default:p(()=>[l(y,{span:"12"},{default:p(()=>[l(d,{"title-placement":"left",style:{"--n-color":"#5d8585","--n-text-color":"#5d8585",margin:"-8vh 0 -10vh 0"}},{default:p(()=>[e._id.length>0?(E(),N("h2",Pt,"編 輯 模 組")):(E(),N("h2",Ht,"新 增 模 組"))]),_:1})]),_:1}),l(y,{span:"12",path:"living"},{default:p(()=>[l(C,{value:e.living,"onUpdate:value":n[1]||(n[1]=r=>e.living=r),size:"large",style:{position:"absolute",right:"0"}},{checked:p(()=>[H(" 公開 ")]),unchecked:p(()=>[H(" 隱藏 ")]),_:1},8,["value"])]),_:1}),l(y,{span:"xs:9 m:6 l:6",label:"模組名稱",path:"name"},{default:p(()=>[l(g,{value:e.name,"onUpdate:value":n[2]||(n[2]=r=>e.name=r),placeholder:"",type:"text"},null,8,["value"])]),_:1}),l(y,{span:"xs:9 m:6 l:6",label:"模組圖片",path:"image"},{default:p(()=>[l(A,{value:e.image,"onUpdate:value":n[3]||(n[3]=r=>e.image=r),"list-type":"image-card",multiple:"",accept:".jpg,.jpeg,.png,.gif,.bmp,.tiff,.svg,.webp","default-file-list":c.value,onChange:f},{default:p(()=>[H(" 新增圖片 ")]),_:1},8,["value","default-file-list"])]),_:1}),l(y,{span:"xs:6 m:3 l:3",label:"預估時長 (以最短時間計算)",path:"minTime"},{default:p(()=>[l(M,{value:e.minTime,"onUpdate:value":n[4]||(n[4]=r=>e.minTime=r),"default-value":1,clearable:""},{suffix:p(()=>[Et]),_:1},8,["value"])]),_:1}),l(y,{span:"xs:6 m:3 l:3",label:"PL 人數",path:"pl"},{default:p(()=>[l(M,{value:e.pl,"onUpdate:value":n[5]||(n[5]=r=>e.pl=r),"default-value":1,clearable:""},{suffix:p(()=>[Nt]),_:1},8,["value"])]),_:1}),l(y,{span:"xs:6 m:3 l:3",label:"特色",path:"hashtag"},{default:p(()=>[x("div",Kt,[l(B,{value:e.hashtag,"onUpdate:value":n[6]||(n[6]=r=>e.hashtag=r),type:"primary",round:"","input-style":"warning"},null,8,["value"])])]),_:1}),l(y,{span:"xs:6 m:3 l:3",label:"難度",path:"difficulty"},{default:p(()=>[l(s,{value:e.difficulty,"onUpdate:value":n[7]||(n[7]=r=>e.difficulty=r),"default-value":.5,"allow-half":"",color:"#4fb233"},null,8,["value","default-value"])]),_:1}),l(y,{span:"xs:9 m:6 l:6",label:"模組說明",path:"info"},{default:p(()=>[l(g,{value:e.info,"onUpdate:value":n[8]||(n[8]=r=>e.info=r),placeholder:"建議這邊只放最簡單的模組介紹就好~",type:"textarea",autosize:{minRows:3,maxRows:10}},null,8,["value"])]),_:1}),l(y,{span:"xs:9 m:6 l:6",label:"額外補充(注意事項)",path:"notice"},{default:p(()=>[l(g,{value:e.notice,"onUpdate:value":n[9]||(n[9]=r=>e.notice=r),placeholder:"有關 HO情報、公開情報、紙娃娃素材...等，是放在這區喔 :))",type:"textarea",autosize:{minRows:3,maxRows:10}},null,8,["value"])]),_:1}),l(y,{span:"xs:9 m:6 l:6",label:"可可亞連結",path:"ccfoliaLink"},{default:p(()=>[l(g,{value:e.ccfoliaLink,"onUpdate:value":n[10]||(n[10]=r=>e.ccfoliaLink=r),placeholder:" ",style:{"background-color":"#F5BBA9"}},null,8,["value"])]),_:1}),l(y,{span:"xs:9 m:6 l:6",label:"Discord 連結",path:"discordLink"},{default:p(()=>[l(g,{value:e.discordLink,"onUpdate:value":n[11]||(n[11]=r=>e.discordLink=r),placeholder:" ",style:{"background-color":"#9D9FDD"}},null,8,["value"])]),_:1}),l(u,{span:"2"},{default:p(()=>[x("div",Gt,[l(o,{type:"error",ghost:"",disabled:e.loading,round:"",size:"large",style:{width:"12vw",height:"3vw","font-size":"1.5vw"},onClick:n[12]||(n[12]=r=>e.showModal=!1)},{default:p(()=>[H(" 取    消 ")]),_:1},8,["disabled"])])]),_:1}),l(u,{span:"2"},{default:p(()=>[x("div",Xt,[l(o,{disabled:e.loading,round:"",type:"primary",size:"large",style:{width:"12vw",height:"3vw","font-size":"1.5vw"},"attr-type":"submit",onKeydown:n[13]||(n[13]=Ae(ce(()=>{},["prevent"]),["enter"]))},{default:p(()=>[H(" 存    檔 ")]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["model","size","onSubmit"])]),_:1},8,["show"])])}}};export{hn as default};
